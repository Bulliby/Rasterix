<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Hello, world!</title>
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <meta name="description" content="" />
        <link rel="icon" href="favicon.png">
    </head>
    <div class="container">
        <iframe id="render" title="Rasterix render window" width="1600" height="1300" src="http://rasterix.test/rasterix.php"></iframe>
        <form>
            <x-range :name.prop="x-rotation"></x-range>
            <h3>ROTATION Z</h3>
            <button id="z-r-up">+</button>
            <button id="z-r-down">-</button>
            <h3>Translation Z</h3>
            <button id="z-up">+</button>
            <button id="z-down">-</button>
            <h3>Translation X</h3>
            <button id="x-up">+</button>
            <button id="x-down">-</button>
            <h3>Translation Y</h3>
            <button id="y-up">+</button>
            <button id="y-down">-</button>
            <h3>ROTATION Y</h3>
            <button id="y-r-up">+</button>
            <button id="y-r-down">-</button>
            <h3>ROTATION X</h3>
            <button id="x-r-up">+</button>
            <button id="x-r-down">-</button>
        </form>
    </div>
</html>

<script type="module">
    import { defineCustomElement } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js'
    const Range = defineCustomElement({
        // normal Vue component options here
        props: {
            name: String,
        },
        data () {
            return  {
                range: 0,
                url: `http://rasterix.test/rasterix.php`,
                prevent: 0
            }
        },
        methods: {
            generate() {
                if (this.prevent === 1)
                    return;
                this.prevent = 1;
                const formData = new FormData();
                formData.append("x-rotation", this.range) 
                fetch(this.url, { method: 'POST', body: formData })
                .then(() => {
                    formData.delete(`${this.name}`) 
                    document.getElementById('render').contentWindow.location.reload();
                    this.prevent = 0;
                });
            }
        },
        template: `<input type="range" v-model="range" @input="generate" min="0" max="3.2" step="0.1"/>`,

        // defineCustomElement only: CSS to be injected into shadow root
        styles: [`/* inlined css */`]
    })

    // Register the custom element.
    // After registration, all `<my-vue-element>` tags
    // on the page will be upgraded.
    customElements.define('x-range', Range)

    // You can also programmatically instantiate the element:
    // (can only be done after registration)
    document.body.appendChild(
        new Range({
            // initial props (optional)
        })
    )
</script>

<style>
* {
    margin-block-start: 0;
    margin-block-end: 0;
}
 body {
     margin: 0;
     overflow: hidden;
 }
 .container {
     display: flex;
 }
</style>
